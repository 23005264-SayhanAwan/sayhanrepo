<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Edit Item</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body>
  <%- include('partials/Adminnav', { admin: admin }) %>
  <div class="container mt-5">
    <h2>Edit Store Item</h2>
    <form action="/admin/editItem/<%= item.ItemID %>" method="POST" enctype="multipart/form-data">
      <div class="mb-3">
        <label for="Name" class="form-label">Name</label>
        <input type="text" class="form-control" id="Name" name="Name" value="<%= item.Name %>" required>
      </div>
      
      <!-- FIXED: Use form-select for Bootstrap 5 -->
      <div class="mb-3">
        <label for="Category" class="form-label">Category</label>
        <select class="form-select" id="Category" name="Category" required>
          <option value="">Select Category</option>
          <option value="Balls" <%= item.Category === 'Balls' ? 'selected' : '' %>> Balls</option>
          <option value="Jerseys" <%= item.Category === 'Jerseys' ? 'selected' : '' %>> Jerseys</option>
          <option value="Bags" <%= item.Category === 'Bags' ? 'selected' : '' %>> Bags</option>
        </select>
      </div>
      
      <div class="mb-3">
        <label for="Price" class="form-label">Price</label>
        <input type="number" step="0.01" class="form-control" id="Price" name="Price" value="<%= item.Price %>" required>
      </div>
      
      <div class="mb-3">
        <label for="itemquantity" class="form-label">Quantity</label>
        <input type="number" min="0" class="form-control" id="itemquantity" name="itemquantity" value="<%= item.itemquantity %>" required>
      </div>
      
      <div class="mb-3">
        <label for="Image" class="form-label">Image (Leave empty to keep current)</label>
        <input type="file" class="form-control" id="Image" name="Image">
        <% if (item.storeitempic) { %>
          <small class="text-muted">Current image: <%= item.storeitempic %></small>
        <% } %>
      </div>
      <button type="submit" class="btn btn-primary">Save Changes</button>
      <a href="/admin/store-items" class="btn btn-secondary ms-2">Cancel</a>
    </form>
  </div>

  <!-- Add debugging script -->
  <script>
    document.querySelector('form').addEventListener('submit', function(e) {
      const category = document.getElementById('Category').value;
      console.log('Selected category:', category);
      
      if (!category) {
        e.preventDefault();
        alert('Please select a category');
      }
    });
  </script>
</body>
</html>